<div {{ attributes.defaults({class: 'margin-component'}) }}>
    {% if data and not data.kategorie %}
        <div class="mb-3">
            <div class="row g-3">
                <div class="col-md-4 mb-2">
                    <label for="kategorie-select" class="form-label">Kategorie</label>
                    <select id="kategorie-select" class="form-select form-select-sm" data-model="kategorie">
                        <option value="">Všechny kategorie</option>
                        {% for kategorieItem in kategorieItems %}
                            <option value="{{ kategorieItem.slug }}">{{ kategorieItem.Nazev }}</option>
                        {% endfor %}
                    </select>
                </div>

                <div class="col-md-4 mb-2">
                    <label for="program-select" class="form-label">Operační program:</label>
                    <select id="program-select" class="form-select form-select-sm" data-model="operacniProgram">
                        <option value="">Všechny operační programy</option>
                        {% for program in operacniProgramyItems %}
                            <option value="{{ program.slug }}">{{ program.Nazev }}</option>
                        {% endfor %}
                    </select>
                </div>

                <div class="col-md-4 mb-2">
                    <label for="obec-select" class="form-label">Obec:</label>
                    <select id="obec-select" class="form-select form-select-sm" data-model="obec">
                        <option value="">Všechny obce</option>
                        {% for obecItem in obceItems %}
                            <option value="{{ obecItem.Nazev }}">{{ obecItem.Nazev }}</option>
                        {% endfor %}
                    </select>
                </div>
            </div>
        </div>
    {% endif %}

    <div class="mb-3">
        <p class="mb-2">Řadit podle:</p>

        <button type="button"
                class="me-1 me-md-2 mb-1 mb-md-2 btn button-style-filter {{ sortBy == 'Nejnovější' ? 'active' : '' }}"
                data-action="live#action"
                data-live-action-param="sort"
                data-live-sort-param="Nejnovější">
            Nejnovější
        </button>

        <button type="button"
                class="me-1 me-md-2 mb-1 mb-md-2 btn button-style-filter {{ sortBy == 'Nejstarší' ? 'active' : '' }}"
                data-action="live#action"
                data-live-action-param="sort"
                data-live-sort-param="Nejstarší">
            Nejstarší
        </button>

        <button type="button"
                class="me-1 me-md-2 mb-1 mb-md-2 btn button-style-filter {{ sortBy == 'Nejdražší' ? 'active' : '' }}"
                data-action="live#action"
                data-live-action-param="sort"
                data-live-sort-param="Nejdražší">
            Nejdražší
        </button>

        <button type="button"
                class="me-1 me-md-2 mb-1 mb-md-2 btn button-style-filter {{ sortBy == 'Nejlevnější' ? 'active' : '' }}"
                data-action="live#action"
                data-live-action-param="sort"
                data-live-sort-param="Nejlevnější">
            Nejlevnější
        </button>
    </div>

    <div class="row align-items-stretch">
        {% for projekt in items %}
            {{ include('_projekt_list_item.html.twig') }}
        {% endfor %}
    </div>

    {% set paginationMeta = this.paginationMeta %}
    {% if paginationMeta.totalPages > 1 %}
        <nav aria-label="Stránkování projektů" class="mt-4">
            <ul class="pagination justify-content-center">
                {# Previous button #}
                {% if paginationMeta.hasPreviousPage() %}
                    <li class="page-item">
                        <button type="button"
                                class="page-link"
                                data-action="live#action"
                                data-live-action-param="changePage"
                                data-live-page-param="{{ paginationMeta.currentPage - 1 }}"
                                aria-label="Předchozí stránka">
                            &laquo;
                        </button>
                    </li>
                {% else %}
                    <li class="page-item disabled">
                        <span class="page-link">&laquo;</span>
                    </li>
                {% endif %}

                {# Page numbers #}
                {% set startPage = max(1, paginationMeta.currentPage - 2) %}
                {% set endPage = min(paginationMeta.totalPages, paginationMeta.currentPage + 2) %}

                {% if startPage > 1 %}
                    <li class="page-item">
                        <button type="button"
                                class="page-link"
                                data-action="live#action"
                                data-live-action-param="changePage"
                                data-live-page-param="1">
                            1
                        </button>
                    </li>
                    {% if startPage > 2 %}
                        <li class="page-item disabled">
                            <span class="page-link">...</span>
                        </li>
                    {% endif %}
                {% endif %}

                {% for pageNumber in startPage..endPage %}
                    <li class="page-item {{ pageNumber == paginationMeta.currentPage ? 'active' : '' }}">
                        {% if pageNumber == paginationMeta.currentPage %}
                            <span class="page-link">{{ pageNumber }}</span>
                        {% else %}
                            <button type="button"
                                    class="page-link"
                                    data-action="live#action"
                                    data-live-action-param="changePage"
                                    data-live-page-param="{{ pageNumber }}">
                                {{ pageNumber }}
                            </button>
                        {% endif %}
                    </li>
                {% endfor %}

                {% if endPage < paginationMeta.totalPages %}
                    {% if endPage < paginationMeta.totalPages - 1 %}
                        <li class="page-item disabled">
                            <span class="page-link">...</span>
                        </li>
                    {% endif %}
                    <li class="page-item">
                        <button type="button"
                                class="page-link"
                                data-action="live#action"
                                data-live-action-param="changePage"
                                data-live-page-param="{{ paginationMeta.totalPages }}">
                            {{ paginationMeta.totalPages }}
                        </button>
                    </li>
                {% endif %}

                {# Next button #}
                {% if paginationMeta.hasNextPage() %}
                    <li class="page-item">
                        <button type="button"
                                class="page-link"
                                data-action="live#action"
                                data-live-action-param="changePage"
                                data-live-page-param="{{ paginationMeta.currentPage + 1 }}"
                                aria-label="Následující stránka">
                            &raquo;
                        </button>
                    </li>
                {% else %}
                    <li class="page-item disabled">
                        <span class="page-link">&raquo;</span>
                    </li>
                {% endif %}
            </ul>

            {# Pagination info #}
            <div class="text-center text-muted small mt-2">
                Stránka {{ paginationMeta.currentPage }} z {{ paginationMeta.totalPages }}
            </div>
        </nav>
    {% endif %}
</div>
